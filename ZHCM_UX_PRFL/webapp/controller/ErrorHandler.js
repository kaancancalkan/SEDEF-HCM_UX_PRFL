/*
 * Copyright (C) 2009-2018 SAP SE or an SAP affiliate company. All rights reserved.
 */
sap.ui.define(["sap/ui/base/Object","sap/m/MessageBox"],function(e,r){"use strict";function s(e){var r,s={sMessage:e,sDetails:null,aInnerErrors:[]};try{r=JSON.parse(e);if(r&&r.error){if(r.error.message&&r.error.message.value){s.sMessage=r.error.message.value}if(r.error.code){s.sDetails=r.error.code}if(r.error.innererror&&r.error.innererror.errordetails){s.aInnerErrors=r.error.innererror.errordetails}}}catch(r){try{var t=jQuery.parseXML(e)}catch(e){jQuery.sap.log.error(e)}if(t){s.sMessage=t.getElementsByTagName("message")[0].childNodes[0].nodeValue||t.documentElement;s.sDetails=t.getElementsByTagName("code")[0].childNodes[0].nodeValue;s.aInnerErrors=t.getElementsByTagName("errordetail")}else{s.sMessage=e}}return s}function t(e){var r=null,t=null;r=e.getParameters?e.getParameters():null;t=r?r.response||r:e;var o=t.responseText||t.body||t.response&&t.response.body||"";return s(o)}return e.extend("com.sedef.hcm.ux.myprofile.controller.ErrorHandler",{constructor:function(e){this._oResourceBundle=e.getModel("i18n").getResourceBundle();this._oComponent=e;this._oModel=e.getModel();this._sErrorText=this._oResourceBundle.getText("errorTitle");this._oModel.attachMetadataFailed(function(e){var r=e.getParameters();this._showMetadataError(r.response)},this);this._oModel.attachRequestFailed(this.onRequestFailed,this)},onRequestFailed:function(e){var r=t(e);this._showServiceError(r.sMessage,r.sDetails)},showErrorMsg:function(e,s){var o=t(e);r.show(o.sMessage,{icon:r.Icon.ERROR,title:this._oResourceBundle.getText("errorTitle"),details:o.sDetails,actions:r.Action.CLOSE,onClose:s,styleClass:this._oComponent.getContentDensityClass()})},_showMetadataError:function(e){r.error(this._sErrorText,{details:e,styleClass:this._oComponent.getContentDensityClass(),actions:[r.Action.RETRY,r.Action.CLOSE],onClose:function(e){if(e===r.Action.RETRY){this._oModel.refreshMetadata()}}.bind(this)})},_showServiceError:function(e,s,t){if(this._bMessageOpen){return}this._bMessageOpen=true;r.error(e,{title:t?t:this._sErrorText,details:s,styleClass:this._oComponent.getContentDensityClass(),actions:[r.Action.CLOSE],onClose:function(){this._bMessageOpen=false}.bind(this)})}})});
//# sourceMappingURL=ErrorHandler.js.map