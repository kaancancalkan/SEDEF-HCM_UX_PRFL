/*
 * Copyright (C) 2009-2018 SAP SE or an SAP affiliate company. All rights reserved.
 */
sap.ui.define(["com/sedef/hcm/ux/myprofile/controller/BaseController","com/sedef/hcm/ux/myprofile/utils/formatter","com/sedef/hcm/ux/myprofile/utils/reuseHandler","com/sedef/hcm/ux/myprofile/controller/ErrorHandler","sap/ui/model/json/JSONModel","sap/ui/model/Filter","sap/ui/model/FilterOperator"],function(e,t,o,i,n,r,l){"use strict";return e.extend("com.sedef.hcm.ux.myprofile.blocks.TimeBalanceBlockController",{formatter:t,onInit:function(){var e=this.getView(),t=o.getOwnerComponent(),i=t.getModel("appProperties"),r=i.getProperty("/employeeId"),l=i.getProperty("/applicationController"),s=l.getAppNavProperties(),a=l.getAppEntities(),p=new n({busy:false});this.setModel(p,"TimeBalanceView");this.oApplicationController=l;if(l.navPropertyExists(a.EMPLOYEEDETAIL,s.TIMEBALANCE)){e.bindElement(s.TIMEBALANCE)}else{sap.ui.getCore().getEventBus().subscribe("com.sedef.hcm.ux.myprofile","employeeIdChanged",this.onEmployeeIdChange,this);l.whenMetadataLoaded(function(){p.setProperty("/busy",true);this._bindView(r)}.bind(this))}},onExit:function(){sap.ui.getCore().getEventBus().unsubscribe("com.sedef.hcm.ux.myprofile","employeeIdChanged",this.onEmployeeIdChange,this)},onEmployeeIdChange:function(e,t,o){this._bindView(o.EmployeeId)},onNavToMyTimeEvents:function(){this.oApplicationController.navToExternal(this.oApplicationController.getCrossAppNavIntends().TIMEEVENTS.target)},formatTimeBalanceStatusText:function(e){var t=o.getOwnerComponent().getModel("i18n").getResourceBundle();if(parseFloat(e)<0){return t.getText("timeBalMissing")}else if(parseFloat(e)>0){return t.getText("timeBalPositiveTxt")}else{return t.getText("timeBalComplete")}},formatTimeBalanceStatus:function(e){if(parseFloat(e)<0){return sap.ui.core.ValueState.Warning}else{return sap.ui.core.ValueState.Success}},_bindView:function(e){var t=this.oApplicationController.getEmployeeDataModelForEmployeeId(e),o=this.getView(),i=this.getModel("TimeBalanceView"),s=[new r("EmployeeNumber",l.EQ,e)],a=function(e){if(!e.results||e.results&&e.results.length===0){t.setProperty("/bTimeBalanceExists",false)}else{t.setProperty("/bTimeBalanceExists",true);o.setModel(new n({TimeBalance:e.results[0]}));o.bindElement("/TimeBalance")}i.setProperty("/busy",false)};this.oApplicationController.getODataHelper().read("/TimeBalanceSet",a,s)}})});
//# sourceMappingURL=TimeBalanceBlockController.controller.js.map