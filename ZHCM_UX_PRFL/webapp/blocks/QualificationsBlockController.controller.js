/*
 * Copyright (C) 2009-2018 SAP SE or an SAP affiliate company. All rights reserved.
 */
sap.ui.define(["com/sedef/hcm/ux/myprofile/controller/BaseController","sap/ui/model/Filter","sap/ui/model/FilterOperator","sap/ui/model/json/JSONModel","sap/ui/model/Sorter","com/sedef/hcm/ux/myprofile/utils/reuseHandler","sap/ui/Device","sap/ui/core/format/DateFormat"],function(e,t,i,o,a,n,s,r){"use strict";return e.extend("com.sedef.hcm.ux.myprofile.blocks.QualificationsBlockController",{onInit:function(){var e=this.byId("qualiContainer"),a=this.byId("qualiCustItem"),r=n.getOwnerComponent().getModel("appProperties"),l=r.getProperty("/applicationController"),u=l.getAppNavProperties(),p=l.getAppEntities(),d=new o({qualificationsExist:true,busy:false});this.setModel(d,"QualificationsView");this.oResourceBundle=n.getOwnerComponent().getModel("i18n").getResourceBundle();this.oApplicationController=l;this.sEmployeeNumber=r.getProperty("/employeeId");this.sAggregationName=s.system.phone?"pages":"content";this.oView.addDependent(a);if(!l.navPropertyExists(p.EMPLOYEEDETAIL,u.QUALIFICATIONS)){sap.ui.getCore().getEventBus().subscribe("com.sedef.hcm.ux.myprofile","employeeIdChanged",this.onEmployeeIdChange,this);e.bindAggregation(this.sAggregationName,{path:"/QualificationSet",template:a,templateShareable:true,filters:new t("EmployeeNumber",i.EQ,this.sEmployeeNumber),events:{dataRequested:this.onDataRequested.bind(this),dataReceived:this.onDataReceived.bind(this)}})}},onExit:function(){sap.ui.getCore().getEventBus().unsubscribe("com.sedef.hcm.ux.myprofile","employeeIdChanged",this.onEmployeeIdChange,this)},onEmployeeIdChange:function(e,o,a){var n=this.byId("qualiContainer").getBinding(this.sAggregationName);n.filter(new t("EmployeeNumber",i.EQ,a.EmployeeId),sap.ui.model.FilterType.Application)},onDataRequested:function(){var e=this.getModel("QualificationsView");this.oApplicationController.whenMetadataLoaded(function(){e.setProperty("/busy",true)})},onDataReceived:function(e){var t=this.getModel("QualificationsView"),i=this.oApplicationController.getEmployeeDataModelForEmployeeId(this.sEmployeeNumber),o=e.getParameter("data");i.setProperty("/bQualificationsExist",!o.results||o.results&&o.results.length===0);t.setProperty("/busy",false)},formatNoQualificationsText:function(e){var t=n.getOwnerComponent().getModel("appProperties").getProperty("/oConfigData");if(t.QualificationsDuration){var i=r.getDateInstance({style:"long"}),o=n.calculateDateFromDuration(t.QualificationsDuration,"-");return jQuery.sap.formatMessage(e,[i.format(o)])}return this.oResourceBundle.getText("noQualificationsTxt")}})});
//# sourceMappingURL=QualificationsBlockController.controller.js.map